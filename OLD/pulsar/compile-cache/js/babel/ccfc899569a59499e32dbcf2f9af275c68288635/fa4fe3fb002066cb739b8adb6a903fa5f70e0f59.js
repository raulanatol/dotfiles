'use babel';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _mruItemView = _interopRequireDefault(require("./mru-item-view"));
var _atom = require("atom");
function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }
const displayListConfigKey = 'tabs.displayMruTabList';
class MRUListView {
  initialize(pane) {
    this.ownerDiv = document.createElement('div');
    this.element = document.createElement('ol');
    this.ownerDiv.appendChild(this.element);
    this.ownerDiv.classList.add('select-list', 'tabs-mru-switcher');
    this.pane = pane;
    this.pendingShow = false;
    this.subscribe();
    this.panel = atom.workspace.addModalPanel({
      item: this.ownerDiv,
      visible: false
    });
    this.element.classList.add('list-group');
    this.displayMruList = atom.config.get(displayListConfigKey);
    this.hideClickHandler = this.hide.bind(this);
    this.preventPropagationClickHandler = this.preventPropagation.bind(this);
  }
  subscribe() {
    this.subscriptions = new _atom.CompositeDisposable();
    this.subscriptions.add(atom.config.observe(displayListConfigKey, newValue => this.displayMruList = newValue));

    /* Check for existence of events. Allows package tests to pass until this
    change hits stable. */
    if (typeof this.pane.onChooseNextMRUItem === 'function') {
      /* Because the chosen item is passed in the callback, both the
      ChooseNext and ChooseLast events can call our our single choose
      method. */
      this.subscriptions.add(this.pane.onChooseNextMRUItem(item => this.choose(item)));
      this.subscriptions.add(this.pane.onChooseLastMRUItem(item => this.choose(item)));
      this.subscriptions.add(this.pane.onDoneChoosingMRUItem(() => this.stopChoosing()));
    }
    this.subscriptions.add(this.pane.onDidDestroy(() => this.destroy()));
    this.subscriptions.add(atom.commands.add('atom-workspace', {
      'core:cancel': event => {
        if (this.hide()) event.stopPropagation();
      }
    }));
  }
  destroy() {
    this.subscriptions.dispose();
    this.panel.destroy();
  }
  choose(selectedItem) {
    if (this.displayMruList) {
      this.pendingShow = true;
      this.show(selectedItem);
    }
  }
  stopChoosing() {
    if (this.displayMruList) {
      this.pendingShow = false;
      this.hide();
    }
  }
  show(selectedItem) {
    let selectedViewElement;
    if (!this.panel.visible) {
      window.setTimeout(() => {
        if (!this.pendingShow) return;
        selectedViewElement = this.buildListView(selectedItem);
        this.panel.show();
        this.addClickHandlers();
        this.scrollToItemView(selectedViewElement);
      }, 150);
    } else {
      selectedViewElement = this.updateSelectedItem(selectedItem);
      this.scrollToItemView(selectedViewElement);
    }
  }
  preventPropagation() {
    event.stopPropagation();
  }
  addClickHandlers() {
    document.body.addEventListener('click', this.hideClickHandler);
    this.ownerDiv.addEventListener('click', this.preventPropagationClickHandler);
  }
  removeClickHandler() {
    document.body.removeEventListener('click', this.hideClickHandler);
    this.ownerDiv.removeEventListener('click', this.preventPropagationClickHandler);
  }
  hide() {
    const willClose = this.panel.visible;
    if (willClose) {
      this.removeClickHandler();
      this.panel.hide();
    }
    return willClose;
  }
  updateSelectedItem(selectedItem) {
    let selectedView;
    for (let viewElement of this.element.children) {
      if (viewElement.itemViewData.item === selectedItem) {
        viewElement.itemViewData.select();
        selectedView = viewElement;
      } else viewElement.itemViewData.unselect();
    }
    return selectedView;
  }
  scrollToItemView(view) {
    const desiredTop = view.offsetTop;
    const desiredBottom = desiredTop + view.offsetHeight;
    if (desiredTop < this.element.scrollTop) {
      this.element.scrollTop = desiredTop;
    } else if (desiredBottom > this.element.scrollTop + this.element.clientHeight) {
      this.element.scrollTop = desiredBottom - this.element.clientHeight;
    }
  }
  buildListView(selectedItem) {
    /* Making this more efficient, and not simply building the view for the
    entire stack every time it's shown, has significant complexity cost.
    The pane system completely owns the MRU stack. Adding events and
    handlers to incrementally update the UI here would mean two copies of
    the stack to maintain and keep in sync. Let's take on that complexity
    only if this exhibits real-world performance issues. */
    while (this.element.firstChild) this.element.removeChild(this.element.firstChild);
    let selectedViewElement;
    /* We're inserting each item at the top so we traverse the stack from
    the bottom, resulting in the most recently used item at the top of the
    UI. */
    for (let i = this.pane.itemStack.length - 1; i >= 0; i--) {
      let item = this.pane.itemStack[i];
      let itemView = new _mruItemView.default();
      itemView.initialize(this, item);
      if (itemView.disposables) {
        this.subscriptions.add(itemView.disposables);
      }
      this.element.appendChild(itemView.element);
      if (item === selectedItem) {
        itemView.select();
        selectedViewElement = itemView;
      }
    }
    return selectedViewElement.element;
  }
}
exports.default = MRUListView;
module.exports = exports.default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJkaXNwbGF5TGlzdENvbmZpZ0tleSIsIk1SVUxpc3RWaWV3IiwiaW5pdGlhbGl6ZSIsInBhbmUiLCJvd25lckRpdiIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImVsZW1lbnQiLCJhcHBlbmRDaGlsZCIsImNsYXNzTGlzdCIsImFkZCIsInBlbmRpbmdTaG93Iiwic3Vic2NyaWJlIiwicGFuZWwiLCJhdG9tIiwid29ya3NwYWNlIiwiYWRkTW9kYWxQYW5lbCIsIml0ZW0iLCJ2aXNpYmxlIiwiZGlzcGxheU1ydUxpc3QiLCJjb25maWciLCJnZXQiLCJoaWRlQ2xpY2tIYW5kbGVyIiwiaGlkZSIsImJpbmQiLCJwcmV2ZW50UHJvcGFnYXRpb25DbGlja0hhbmRsZXIiLCJwcmV2ZW50UHJvcGFnYXRpb24iLCJzdWJzY3JpcHRpb25zIiwiQ29tcG9zaXRlRGlzcG9zYWJsZSIsIm9ic2VydmUiLCJuZXdWYWx1ZSIsIm9uQ2hvb3NlTmV4dE1SVUl0ZW0iLCJjaG9vc2UiLCJvbkNob29zZUxhc3RNUlVJdGVtIiwib25Eb25lQ2hvb3NpbmdNUlVJdGVtIiwic3RvcENob29zaW5nIiwib25EaWREZXN0cm95IiwiZGVzdHJveSIsImNvbW1hbmRzIiwiZXZlbnQiLCJzdG9wUHJvcGFnYXRpb24iLCJkaXNwb3NlIiwic2VsZWN0ZWRJdGVtIiwic2hvdyIsInNlbGVjdGVkVmlld0VsZW1lbnQiLCJ3aW5kb3ciLCJzZXRUaW1lb3V0IiwiYnVpbGRMaXN0VmlldyIsImFkZENsaWNrSGFuZGxlcnMiLCJzY3JvbGxUb0l0ZW1WaWV3IiwidXBkYXRlU2VsZWN0ZWRJdGVtIiwiYm9keSIsImFkZEV2ZW50TGlzdGVuZXIiLCJyZW1vdmVDbGlja0hhbmRsZXIiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwid2lsbENsb3NlIiwic2VsZWN0ZWRWaWV3Iiwidmlld0VsZW1lbnQiLCJjaGlsZHJlbiIsIml0ZW1WaWV3RGF0YSIsInNlbGVjdCIsInVuc2VsZWN0IiwidmlldyIsImRlc2lyZWRUb3AiLCJvZmZzZXRUb3AiLCJkZXNpcmVkQm90dG9tIiwib2Zmc2V0SGVpZ2h0Iiwic2Nyb2xsVG9wIiwiY2xpZW50SGVpZ2h0IiwiZmlyc3RDaGlsZCIsInJlbW92ZUNoaWxkIiwiaSIsIml0ZW1TdGFjayIsImxlbmd0aCIsIml0ZW1WaWV3IiwiTVJVSXRlbVZpZXciLCJkaXNwb3NhYmxlcyJdLCJzb3VyY2VzIjpbIm1ydS1saXN0LXZpZXcuanMiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBiYWJlbCdcblxuaW1wb3J0IE1SVUl0ZW1WaWV3IGZyb20gJy4vbXJ1LWl0ZW0tdmlldydcbmltcG9ydCB7Q29tcG9zaXRlRGlzcG9zYWJsZX0gZnJvbSAnYXRvbSdcblxuY29uc3QgZGlzcGxheUxpc3RDb25maWdLZXkgPSAndGFicy5kaXNwbGF5TXJ1VGFiTGlzdCdcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTVJVTGlzdFZpZXcge1xuICBpbml0aWFsaXplIChwYW5lKSB7XG4gICAgdGhpcy5vd25lckRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgdGhpcy5lbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb2wnKVxuICAgIHRoaXMub3duZXJEaXYuYXBwZW5kQ2hpbGQodGhpcy5lbGVtZW50KVxuICAgIHRoaXMub3duZXJEaXYuY2xhc3NMaXN0LmFkZCgnc2VsZWN0LWxpc3QnLCAndGFicy1tcnUtc3dpdGNoZXInKVxuXG4gICAgdGhpcy5wYW5lID0gcGFuZVxuICAgIHRoaXMucGVuZGluZ1Nob3cgPSBmYWxzZVxuICAgIHRoaXMuc3Vic2NyaWJlKClcbiAgICB0aGlzLnBhbmVsID0gYXRvbS53b3Jrc3BhY2UuYWRkTW9kYWxQYW5lbCh7XG4gICAgICBpdGVtOiB0aGlzLm93bmVyRGl2LFxuICAgICAgdmlzaWJsZTogZmFsc2VcbiAgICB9KVxuICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKCdsaXN0LWdyb3VwJylcblxuICAgIHRoaXMuZGlzcGxheU1ydUxpc3QgPSBhdG9tLmNvbmZpZy5nZXQoZGlzcGxheUxpc3RDb25maWdLZXkpXG4gICAgdGhpcy5oaWRlQ2xpY2tIYW5kbGVyID0gdGhpcy5oaWRlLmJpbmQodGhpcylcbiAgICB0aGlzLnByZXZlbnRQcm9wYWdhdGlvbkNsaWNrSGFuZGxlciA9IHRoaXMucHJldmVudFByb3BhZ2F0aW9uLmJpbmQodGhpcylcbiAgfVxuXG4gIHN1YnNjcmliZSAoKSB7XG4gICAgdGhpcy5zdWJzY3JpcHRpb25zID0gbmV3IENvbXBvc2l0ZURpc3Bvc2FibGUoKVxuXG4gICAgdGhpcy5zdWJzY3JpcHRpb25zLmFkZChhdG9tLmNvbmZpZy5vYnNlcnZlKFxuICAgICAgZGlzcGxheUxpc3RDb25maWdLZXksXG4gICAgICAobmV3VmFsdWUpID0+ICh0aGlzLmRpc3BsYXlNcnVMaXN0ID0gbmV3VmFsdWUpKSlcblxuICAgIC8qIENoZWNrIGZvciBleGlzdGVuY2Ugb2YgZXZlbnRzLiBBbGxvd3MgcGFja2FnZSB0ZXN0cyB0byBwYXNzIHVudGlsIHRoaXNcbiAgICBjaGFuZ2UgaGl0cyBzdGFibGUuICovXG4gICAgaWYgKHR5cGVvZiB0aGlzLnBhbmUub25DaG9vc2VOZXh0TVJVSXRlbSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgLyogQmVjYXVzZSB0aGUgY2hvc2VuIGl0ZW0gaXMgcGFzc2VkIGluIHRoZSBjYWxsYmFjaywgYm90aCB0aGVcbiAgICAgIENob29zZU5leHQgYW5kIENob29zZUxhc3QgZXZlbnRzIGNhbiBjYWxsIG91ciBvdXIgc2luZ2xlIGNob29zZVxuICAgICAgbWV0aG9kLiAqL1xuICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLmFkZChcbiAgICAgICAgdGhpcy5wYW5lLm9uQ2hvb3NlTmV4dE1SVUl0ZW0oKGl0ZW0pID0+IHRoaXMuY2hvb3NlKGl0ZW0pKSlcbiAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5hZGQoXG4gICAgICAgIHRoaXMucGFuZS5vbkNob29zZUxhc3RNUlVJdGVtKChpdGVtKSA9PiB0aGlzLmNob29zZShpdGVtKSkpXG5cbiAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5hZGQoXG4gICAgICAgIHRoaXMucGFuZS5vbkRvbmVDaG9vc2luZ01SVUl0ZW0oKCkgPT4gdGhpcy5zdG9wQ2hvb3NpbmcoKSkpXG4gICAgfVxuXG4gICAgdGhpcy5zdWJzY3JpcHRpb25zLmFkZChcbiAgICAgIHRoaXMucGFuZS5vbkRpZERlc3Ryb3koKCkgPT4gdGhpcy5kZXN0cm95KCkpKVxuXG4gICAgdGhpcy5zdWJzY3JpcHRpb25zLmFkZChcbiAgICAgIGF0b20uY29tbWFuZHMuYWRkKCdhdG9tLXdvcmtzcGFjZScsIHtcbiAgICAgICAgJ2NvcmU6Y2FuY2VsJzogKGV2ZW50KSA9PiB7XG4gICAgICAgICAgaWYgKHRoaXMuaGlkZSgpKSBldmVudC5zdG9wUHJvcGFnYXRpb24oKVxuICAgICAgICB9XG4gICAgICB9KVxuICAgIClcbiAgfVxuXG4gIGRlc3Ryb3kgKCkge1xuICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5kaXNwb3NlKClcbiAgICB0aGlzLnBhbmVsLmRlc3Ryb3koKVxuICB9XG5cbiAgY2hvb3NlIChzZWxlY3RlZEl0ZW0pIHtcbiAgICBpZiAodGhpcy5kaXNwbGF5TXJ1TGlzdCkge1xuICAgICAgdGhpcy5wZW5kaW5nU2hvdyA9IHRydWVcbiAgICAgIHRoaXMuc2hvdyhzZWxlY3RlZEl0ZW0pXG4gICAgfVxuICB9XG5cbiAgc3RvcENob29zaW5nICgpIHtcbiAgICBpZiAodGhpcy5kaXNwbGF5TXJ1TGlzdCkge1xuICAgICAgdGhpcy5wZW5kaW5nU2hvdyA9IGZhbHNlXG4gICAgICB0aGlzLmhpZGUoKVxuICAgIH1cbiAgfVxuXG4gIHNob3cgKHNlbGVjdGVkSXRlbSkge1xuICAgIGxldCBzZWxlY3RlZFZpZXdFbGVtZW50XG4gICAgaWYgKCF0aGlzLnBhbmVsLnZpc2libGUpIHtcbiAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgaWYgKCF0aGlzLnBlbmRpbmdTaG93KSByZXR1cm5cbiAgICAgICAgc2VsZWN0ZWRWaWV3RWxlbWVudCA9IHRoaXMuYnVpbGRMaXN0VmlldyhzZWxlY3RlZEl0ZW0pXG4gICAgICAgIHRoaXMucGFuZWwuc2hvdygpXG4gICAgICAgIHRoaXMuYWRkQ2xpY2tIYW5kbGVycygpXG4gICAgICAgIHRoaXMuc2Nyb2xsVG9JdGVtVmlldyhzZWxlY3RlZFZpZXdFbGVtZW50KVxuICAgICAgfSwgMTUwKVxuICAgIH0gZWxzZSB7XG4gICAgICBzZWxlY3RlZFZpZXdFbGVtZW50ID0gdGhpcy51cGRhdGVTZWxlY3RlZEl0ZW0oc2VsZWN0ZWRJdGVtKVxuICAgICAgdGhpcy5zY3JvbGxUb0l0ZW1WaWV3KHNlbGVjdGVkVmlld0VsZW1lbnQpXG4gICAgfVxuICB9XG5cbiAgcHJldmVudFByb3BhZ2F0aW9uICgpIHtcbiAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKVxuICB9XG5cbiAgYWRkQ2xpY2tIYW5kbGVycyAoKSB7XG4gICAgZG9jdW1lbnQuYm9keS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuaGlkZUNsaWNrSGFuZGxlcilcbiAgICB0aGlzLm93bmVyRGl2LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5wcmV2ZW50UHJvcGFnYXRpb25DbGlja0hhbmRsZXIpXG4gIH1cblxuICByZW1vdmVDbGlja0hhbmRsZXIgKCkge1xuICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmhpZGVDbGlja0hhbmRsZXIpXG4gICAgdGhpcy5vd25lckRpdi5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMucHJldmVudFByb3BhZ2F0aW9uQ2xpY2tIYW5kbGVyKVxuICB9XG5cbiAgaGlkZSAoKSB7XG4gICAgY29uc3Qgd2lsbENsb3NlID0gdGhpcy5wYW5lbC52aXNpYmxlXG4gICAgaWYgKHdpbGxDbG9zZSkge1xuICAgICAgdGhpcy5yZW1vdmVDbGlja0hhbmRsZXIoKVxuICAgICAgdGhpcy5wYW5lbC5oaWRlKClcbiAgICB9XG4gICAgcmV0dXJuIHdpbGxDbG9zZVxuICB9XG5cbiAgdXBkYXRlU2VsZWN0ZWRJdGVtIChzZWxlY3RlZEl0ZW0pIHtcbiAgICBsZXQgc2VsZWN0ZWRWaWV3XG4gICAgZm9yIChsZXQgdmlld0VsZW1lbnQgb2YgdGhpcy5lbGVtZW50LmNoaWxkcmVuKSB7XG4gICAgICBpZiAodmlld0VsZW1lbnQuaXRlbVZpZXdEYXRhLml0ZW0gPT09IHNlbGVjdGVkSXRlbSkge1xuICAgICAgICB2aWV3RWxlbWVudC5pdGVtVmlld0RhdGEuc2VsZWN0KClcbiAgICAgICAgc2VsZWN0ZWRWaWV3ID0gdmlld0VsZW1lbnRcbiAgICAgIH0gZWxzZSB2aWV3RWxlbWVudC5pdGVtVmlld0RhdGEudW5zZWxlY3QoKVxuICAgIH1cbiAgICByZXR1cm4gc2VsZWN0ZWRWaWV3XG4gIH1cblxuICBzY3JvbGxUb0l0ZW1WaWV3ICh2aWV3KSB7XG4gICAgY29uc3QgZGVzaXJlZFRvcCA9IHZpZXcub2Zmc2V0VG9wXG4gICAgY29uc3QgZGVzaXJlZEJvdHRvbSA9IGRlc2lyZWRUb3AgKyB2aWV3Lm9mZnNldEhlaWdodFxuXG4gICAgaWYgKGRlc2lyZWRUb3AgPCB0aGlzLmVsZW1lbnQuc2Nyb2xsVG9wKSB7XG4gICAgICB0aGlzLmVsZW1lbnQuc2Nyb2xsVG9wID0gZGVzaXJlZFRvcFxuICAgIH0gZWxzZSBpZiAoZGVzaXJlZEJvdHRvbSA+IHRoaXMuZWxlbWVudC5zY3JvbGxUb3AgKyB0aGlzLmVsZW1lbnQuY2xpZW50SGVpZ2h0KSB7XG4gICAgICB0aGlzLmVsZW1lbnQuc2Nyb2xsVG9wID0gZGVzaXJlZEJvdHRvbSAtIHRoaXMuZWxlbWVudC5jbGllbnRIZWlnaHRcbiAgICB9XG4gIH1cblxuICBidWlsZExpc3RWaWV3IChzZWxlY3RlZEl0ZW0pIHtcbiAgICAvKiBNYWtpbmcgdGhpcyBtb3JlIGVmZmljaWVudCwgYW5kIG5vdCBzaW1wbHkgYnVpbGRpbmcgdGhlIHZpZXcgZm9yIHRoZVxuICAgIGVudGlyZSBzdGFjayBldmVyeSB0aW1lIGl0J3Mgc2hvd24sIGhhcyBzaWduaWZpY2FudCBjb21wbGV4aXR5IGNvc3QuXG4gICAgVGhlIHBhbmUgc3lzdGVtIGNvbXBsZXRlbHkgb3ducyB0aGUgTVJVIHN0YWNrLiBBZGRpbmcgZXZlbnRzIGFuZFxuICAgIGhhbmRsZXJzIHRvIGluY3JlbWVudGFsbHkgdXBkYXRlIHRoZSBVSSBoZXJlIHdvdWxkIG1lYW4gdHdvIGNvcGllcyBvZlxuICAgIHRoZSBzdGFjayB0byBtYWludGFpbiBhbmQga2VlcCBpbiBzeW5jLiBMZXQncyB0YWtlIG9uIHRoYXQgY29tcGxleGl0eVxuICAgIG9ubHkgaWYgdGhpcyBleGhpYml0cyByZWFsLXdvcmxkIHBlcmZvcm1hbmNlIGlzc3Vlcy4gKi9cbiAgICB3aGlsZSAodGhpcy5lbGVtZW50LmZpcnN0Q2hpbGQpIHRoaXMuZWxlbWVudC5yZW1vdmVDaGlsZCh0aGlzLmVsZW1lbnQuZmlyc3RDaGlsZClcblxuICAgIGxldCBzZWxlY3RlZFZpZXdFbGVtZW50XG4gICAgLyogV2UncmUgaW5zZXJ0aW5nIGVhY2ggaXRlbSBhdCB0aGUgdG9wIHNvIHdlIHRyYXZlcnNlIHRoZSBzdGFjayBmcm9tXG4gICAgdGhlIGJvdHRvbSwgcmVzdWx0aW5nIGluIHRoZSBtb3N0IHJlY2VudGx5IHVzZWQgaXRlbSBhdCB0aGUgdG9wIG9mIHRoZVxuICAgIFVJLiAqL1xuICAgIGZvciAobGV0IGkgPSB0aGlzLnBhbmUuaXRlbVN0YWNrLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICBsZXQgaXRlbSA9IHRoaXMucGFuZS5pdGVtU3RhY2tbaV1cbiAgICAgIGxldCBpdGVtVmlldyA9IG5ldyBNUlVJdGVtVmlldygpXG4gICAgICBpdGVtVmlldy5pbml0aWFsaXplKHRoaXMsIGl0ZW0pXG4gICAgICBpZiAoaXRlbVZpZXcuZGlzcG9zYWJsZXMpIHtcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLmFkZChpdGVtVmlldy5kaXNwb3NhYmxlcylcbiAgICAgIH1cbiAgICAgIHRoaXMuZWxlbWVudC5hcHBlbmRDaGlsZChpdGVtVmlldy5lbGVtZW50KVxuICAgICAgaWYgKGl0ZW0gPT09IHNlbGVjdGVkSXRlbSkge1xuICAgICAgICBpdGVtVmlldy5zZWxlY3QoKVxuICAgICAgICBzZWxlY3RlZFZpZXdFbGVtZW50ID0gaXRlbVZpZXdcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHNlbGVjdGVkVmlld0VsZW1lbnQuZWxlbWVudFxuICB9XG59XG4iXSwibWFwcGluZ3MiOiJBQUFBLFdBQVc7O0FBQUE7RUFBQTtBQUFBO0FBQUE7QUFFWDtBQUNBO0FBQXdDO0FBRXhDLE1BQU1BLG9CQUFvQixHQUFHLHdCQUF3QjtBQUV0QyxNQUFNQyxXQUFXLENBQUM7RUFDL0JDLFVBQVUsQ0FBRUMsSUFBSSxFQUFFO0lBQ2hCLElBQUksQ0FBQ0MsUUFBUSxHQUFHQyxRQUFRLENBQUNDLGFBQWEsQ0FBQyxLQUFLLENBQUM7SUFDN0MsSUFBSSxDQUFDQyxPQUFPLEdBQUdGLFFBQVEsQ0FBQ0MsYUFBYSxDQUFDLElBQUksQ0FBQztJQUMzQyxJQUFJLENBQUNGLFFBQVEsQ0FBQ0ksV0FBVyxDQUFDLElBQUksQ0FBQ0QsT0FBTyxDQUFDO0lBQ3ZDLElBQUksQ0FBQ0gsUUFBUSxDQUFDSyxTQUFTLENBQUNDLEdBQUcsQ0FBQyxhQUFhLEVBQUUsbUJBQW1CLENBQUM7SUFFL0QsSUFBSSxDQUFDUCxJQUFJLEdBQUdBLElBQUk7SUFDaEIsSUFBSSxDQUFDUSxXQUFXLEdBQUcsS0FBSztJQUN4QixJQUFJLENBQUNDLFNBQVMsRUFBRTtJQUNoQixJQUFJLENBQUNDLEtBQUssR0FBR0MsSUFBSSxDQUFDQyxTQUFTLENBQUNDLGFBQWEsQ0FBQztNQUN4Q0MsSUFBSSxFQUFFLElBQUksQ0FBQ2IsUUFBUTtNQUNuQmMsT0FBTyxFQUFFO0lBQ1gsQ0FBQyxDQUFDO0lBQ0YsSUFBSSxDQUFDWCxPQUFPLENBQUNFLFNBQVMsQ0FBQ0MsR0FBRyxDQUFDLFlBQVksQ0FBQztJQUV4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